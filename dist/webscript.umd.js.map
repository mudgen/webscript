{"version":3,"file":"webscript.umd.js","sources":["../src/webscript.js"],"sourcesContent":["function templateValues(args) {\r\n  const [strings, ...templateArgs] = args;\r\n  const result = [];\r\n  for (const [index, s] of strings.entries()) {\r\n    if (s !== \"\") {\r\n      result.push(s);\r\n    }\r\n    let arg = templateArgs[index];\r\n    if (typeof arg !== \"undefined\") {\r\n      result.push(arg);\r\n    }\r\n  }\r\n  return result;\r\n}\r\n\r\nlet interpunct = new RegExp(\"·\", \"g\");\r\n\r\nfunction createInitialBuilder(constructor, type) {\r\n  function setPropertyValue(...args) {\r\n    let [value] = args;\r\n    let { props, prop } = this.__element_info__;\r\n    if (typeof value === \"undefined\") {\r\n      props = { ...props };\r\n      delete props[prop];\r\n      return createBuilder({ props, prop: null });\r\n    }\r\n    else if (Array.isArray(value) && Object.isFrozen(value)) {\r\n      value = templateValues(args).join(\"\");\r\n    }\r\n    else if (args.length > 1) {\r\n      value = args;\r\n    }\r\n    props = { ...props, [prop]: value };\r\n    return createBuilder({ props, prop: null });\r\n  }\r\n  function setPropsValues(props) {\r\n    let { props: existingProps } = this.__element_info__;\r\n    props = { ...existingProps, ...props };\r\n    return createBuilder({ props, prop: null });\r\n  }\r\n  function createBuilder(propsInfo) {\r\n    let builder = new Proxy(() => { }, {\r\n      apply(target, thisArg, children) {\r\n        let { props } = builder.__element_info__;\r\n        if (typeof props.exec === \"function\") {\r\n          let exec = props.exec;\r\n          delete props.exec;\r\n          let result = exec(builder, children);\r\n          props.exec = exec;\r\n          return result;\r\n        }\r\n        let [first] = children;\r\n        if (Array.isArray(first) && Object.isFrozen(first)) {\r\n          children = templateValues(children);\r\n        }\r\n        if (Array.isArray(props.children)) {\r\n          props.children.push(...children)\r\n          children = props.children;\r\n          delete props.children;\r\n        }\r\n        for (let i = 0; i < children.length; i++) {\r\n          let arg = children[i];\r\n          if (typeof arg === \"function\" && arg.__element_info__) {\r\n            children[i] = arg();\r\n          }\r\n        }\r\n        return constructor(type, props, ...children);\r\n      },\r\n      get(target, prop) {\r\n        if (prop === \"props\") {\r\n          return setPropsValues;\r\n        }\r\n        else if (prop === \"__element_info__\") {          \r\n          return target[prop]\r\n        }\r\n        else if (typeof prop === \"string\") {\r\n          if (prop.indexOf(\"·\") !== -1) {\r\n            prop = prop.replace(interpunct, \"-\");\r\n          }\r\n          if (prop.endsWith(\"Value\") && prop.length > 5) {\r\n            return target.__element_info__.props[prop.slice(0, -5)];\r\n          }\r\n          target.__element_info__.prop = prop;\r\n          return setPropertyValue;\r\n        }\r\n      }\r\n    })\r\n    builder.__element_info__ = propsInfo;\r\n    return builder;\r\n  }\r\n  return createBuilder({ props: {}, prop: null });\r\n}\r\n\r\n\r\nfunction builders(constructor, types = []) {\r\n  if (typeof constructor !== \"function\") {\r\n    throw Error(\"elementConstructor argument must be present and it must be a function.\");\r\n  }\r\n  if (types.length > 0) {\r\n    let builders = [];\r\n    for (const element of types) {\r\n      builders.push(createInitialBuilder(constructor, element));\r\n    }\r\n    return builders;\r\n  }\r\n  else {\r\n    return new Proxy(() => { }, {\r\n      get(target, prop) {\r\n        const result = target[prop];\r\n        if (typeof result !== \"undefined\") {\r\n          return result;\r\n        }\r\n        target[prop] = createInitialBuilder(constructor, prop);\r\n        return target[prop];\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nexport default builders;\r\n"],"names":["templateValues","args","strings","templateArgs","result","entries","index","s","push","arg","interpunct","RegExp","createInitialBuilder","constructor","type","setPropertyValue","value","this","__element_info__","props","prop","createBuilder","Array","isArray","Object","isFrozen","join","length","setPropsValues","propsInfo","builder","Proxy","apply","target","thisArg","children","exec","first","i","get","indexOf","replace","endsWith","slice","types","Error","builders"],"mappings":"gsCAAA,SAASA,EAAeC,GAGtB,UAFOC,EAA4BD,KAAhBE,EAAgBF,WAC7BG,EAAS,OACUF,EAAQG,0BAAW,eAAhCC,OAAOC,OACP,KAANA,GACFH,EAAOI,KAAKD,GAEd,IAAIE,EAAMN,EAAaG,QACJ,IAARG,GACTL,EAAOI,KAAKC,GAGhB,OAAOL,EAGT,IAAIM,EAAa,IAAIC,OAAO,IAAK,KAEjC,SAASC,EAAqBC,EAAaC,GACzC,SAASC,UAAoBd,6BACbA,EAATe,SACiBC,KAAKC,iBAArBC,IAAAA,MAAOC,IAAAA,KACb,YAAqB,IAAVJ,UACTG,OAAaA,IACAC,GACNC,EAAc,CAAEF,MAAAA,EAAOC,KAAM,SAE7BE,MAAMC,QAAQP,IAAUQ,OAAOC,SAAST,GAC/CA,EAAQhB,EAAeC,GAAMyB,KAAK,IAE3BzB,EAAK0B,OAAS,IACrBX,EAAQf,GAGHoB,EAAc,CAAEF,MADvBA,OAAaA,UAAQC,GAAOJ,MACEI,KAAM,QAEtC,SAASQ,EAAeT,GAGtB,OAAOE,EAAc,CAAEF,MADvBA,OAD+BF,KAAKC,iBAA9BC,MACyBA,GACDC,KAAM,OAEtC,SAASC,EAAcQ,GACrB,IAAIC,EAAU,IAAIC,MAAM,aAAW,CACjCC,eAAMC,EAAQC,EAASC,OACfhB,EAAUW,EAAQZ,iBAAlBC,MACN,GAA0B,mBAAfA,EAAMiB,KAAqB,CACpC,IAAIA,EAAOjB,EAAMiB,YACVjB,EAAMiB,KACb,IAAIhC,EAASgC,EAAKN,EAASK,GAE3B,OADAhB,EAAMiB,KAAOA,EACNhC,EAPsB,MAS1BiC,EAASF,KACVb,MAAMC,QAAQc,IAAUb,OAAOC,SAASY,KAC1CF,EAAWnC,EAAemC,IAExBb,MAAMC,QAAQJ,EAAMgB,eACtBhB,EAAMgB,UAAS3B,aAAQ2B,GACvBA,EAAWhB,EAAMgB,gBACVhB,EAAMgB,UAEf,IAAK,IAAIG,EAAI,EAAGA,EAAIH,EAASR,OAAQW,IAAK,CACxC,IAAI7B,EAAM0B,EAASG,GACA,mBAAR7B,GAAsBA,EAAIS,mBACnCiB,EAASG,GAAK7B,KAGlB,OAAOI,gBAAYC,EAAMK,UAAUgB,KAErCI,aAAIN,EAAQb,GACV,MAAa,UAATA,EACKQ,EAES,qBAATR,EACAa,EAAOb,GAES,iBAATA,IACa,IAAvBA,EAAKoB,QAAQ,OACfpB,EAAOA,EAAKqB,QAAQ/B,EAAY,MAE9BU,EAAKsB,SAAS,UAAYtB,EAAKO,OAAS,EACnCM,EAAOf,iBAAiBC,MAAMC,EAAKuB,MAAM,GAAI,KAEtDV,EAAOf,iBAAiBE,KAAOA,EACxBL,cAKb,OADAe,EAAQZ,iBAAmBW,EACpBC,EAET,OAAOT,EAAc,CAAEF,MAAO,GAAIC,KAAM,cAI1C,SAAkBP,EAAa+B,GAC7B,YAD6BA,IAAAA,EAAQ,IACV,mBAAhB/B,EACT,MAAMgC,MAAM,0EAEd,GAAID,EAAMjB,OAAS,EAAG,CAEpB,IADA,MAAImB,EAAW,OACOF,kBACpBE,EAAStC,KAAKI,EAAqBC,YAErC,OAAOiC,EAGP,WAAWf,MAAM,aAAW,CAC1BQ,aAAIN,EAAQb,GACV,IAAMhB,EAAS6B,EAAOb,GACtB,YAAsB,IAAXhB,EACFA,GAET6B,EAAOb,GAAQR,EAAqBC,EAAaO,GAC1Ca,EAAOb"}